{"ast":null,"code":"import _regeneratorRuntime from\"/Users/Oliwia/bookingapp/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/Oliwia/bookingapp/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"/Users/Oliwia/bookingapp/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/Oliwia/bookingapp/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useState}from\"react\";import useFetch from\"../../hooks/useFetch\";import\"./Reserve.css\";import{useLocation}from\"react-router-dom\";import{SearchContext}from\"../../context/SearchContext\";import axios from\"axios\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Reserve=function Reserve(_ref){var setOpen=_ref.setOpen;var navigate=useNavigate();var location=useLocation();var hotelId=location.pathname.split(\"/\")[2];var _useFetch=useFetch(\"/hotels/room/\".concat(hotelId)),data=_useFetch.data,loading=_useFetch.loading,error=_useFetch.error;var _useContext=useContext(SearchContext),dates=_useContext.dates;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),selectedRooms=_useState2[0],setSelectedRooms=_useState2[1];var getDatesInRange=function getDatesInRange(startDate,endDate){var start=new Date(startDate);var end=new Date(endDate);var date=new Date(start.getTime());var dates=[];while(date<=end){dates.push(new Date(date).getTime());date.setDate(date.getDate()+1);}return dates;};var handleSelect=function handleSelect(e){var checked=e.target.checked;var value=e.target.value;setSelectedRooms(checked?[].concat(_toConsumableArray(selectedRooms),[value]):selectedRooms.filter(function(item){return item!==value;}));};var handleClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return Promise.all(selectedRooms.map(function(roomId){var res=axios.put(\"/rooms/availability/\".concat(roomId),{dates:alldates});return res.data;}));case 3:setOpen(false);navigate(\"/BookingApp\");_context.next=9;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);case 9:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function handleClick(){return _ref2.apply(this,arguments);};}();var alldates=getDatesInRange(dates[0].startDate,dates[0].endDate);var isAvailable=function isAvailable(roomNumber){var isFound=roomNumber.unavailableDates.some(function(date){return alldates.includes(new Date(date).getTime());});return!isFound;};return/*#__PURE__*/_jsx(\"div\",{className:\"reserve\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"reserve-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"reserve-close-icon\",children:/*#__PURE__*/_jsx(\"ion-icon\",{name:\"close-outline\",onClick:function onClick(){return setOpen(false);}})}),/*#__PURE__*/_jsx(\"span\",{className:\"reserve-main-text\",children:\"Select your rooms\"}),data.map(function(item){return/*#__PURE__*/_jsxs(\"div\",{className:\"room-info-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"room-main-infos\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"room-title\",children:item.title}),/*#__PURE__*/_jsx(\"div\",{className:\"room-desc\",children:item.desc}),/*#__PURE__*/_jsxs(\"div\",{className:\"room-price\",children:[\"$\",item.price]}),/*#__PURE__*/_jsxs(\"div\",{className:\"room-max\",children:[\"Max people: \",/*#__PURE__*/_jsx(\"b\",{children:item.maxPeople})]})]}),item.roomNumbers.map(function(roomNumber){return/*#__PURE__*/_jsxs(\"div\",{className:\"room\",children:[/*#__PURE__*/_jsx(\"label\",{children:roomNumber.number}),/*#__PURE__*/_jsx(\"input\",{className:\"room-check\",type:\"checkbox\",value:roomNumber._id,onChange:handleSelect,disabled:!isAvailable(roomNumber)})]});})]},item._id);}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleClick,className:\"reserve-button\",children:[\" \",\"RESERVE NOW!\",\" \"]})]})});};export default Reserve;","map":{"version":3,"names":["React","useContext","useState","useFetch","useLocation","SearchContext","axios","useNavigate","Reserve","setOpen","navigate","location","hotelId","pathname","split","data","loading","error","dates","selectedRooms","setSelectedRooms","getDatesInRange","startDate","endDate","start","Date","end","date","getTime","push","setDate","getDate","handleSelect","e","checked","target","value","filter","item","handleClick","Promise","all","map","roomId","res","put","alldates","isAvailable","roomNumber","isFound","unavailableDates","some","includes","title","desc","price","maxPeople","roomNumbers","number","_id"],"sources":["/Users/Oliwia/bookingapp/client/src/components/Reserve/Reserve.js"],"sourcesContent":["import React, { useContext, useState } from \"react\";\nimport useFetch from \"../../hooks/useFetch\";\nimport \"./Reserve.css\";\nimport { useLocation } from \"react-router-dom\";\nimport { SearchContext } from \"../../context/SearchContext\";\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\n\nconst Reserve = ({ setOpen }) => {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const hotelId = location.pathname.split(\"/\")[2];\n  const { data, loading, error } = useFetch(`/hotels/room/${hotelId}`);\n  const { dates } = useContext(SearchContext);\n  const [selectedRooms, setSelectedRooms] = useState([]);\n\n  const getDatesInRange = (startDate, endDate) => {\n    const start = new Date(startDate);\n    const end = new Date(endDate);\n\n    const date = new Date(start.getTime());\n    const dates = [];\n\n    while (date <= end) {\n      dates.push(new Date(date).getTime());\n      date.setDate(date.getDate() + 1);\n    }\n    return dates;\n  };\n\n  const handleSelect = (e) => {\n    const checked = e.target.checked;\n    const value = e.target.value;\n    setSelectedRooms(\n      checked\n        ? [...selectedRooms, value]\n        : selectedRooms.filter((item) => item !== value)\n    );\n  };\n\n  const handleClick = async () => {\n    try {\n      await Promise.all(\n        selectedRooms.map((roomId) => {\n          const res = axios.put(`/rooms/availability/${roomId}`, {\n            dates: alldates,\n          });\n          return res.data;\n        })\n      );\n      setOpen(false);\n      navigate(\"/BookingApp\");\n    } catch (err) {}\n  };\n\n  const alldates = getDatesInRange(dates[0].startDate, dates[0].endDate);\n\n  const isAvailable = (roomNumber) => {\n    const isFound = roomNumber.unavailableDates.some((date) =>\n      alldates.includes(new Date(date).getTime())\n    );\n    return !isFound;\n  };\n\n  return (\n    <div className=\"reserve\">\n      <div className=\"reserve-container\">\n        <div className=\"reserve-close-icon\">\n          <ion-icon\n            name=\"close-outline\"\n            onClick={() => setOpen(false)}\n          ></ion-icon>\n        </div>\n        <span className=\"reserve-main-text\">Select your rooms</span>\n        {data.map((item) => (\n          <div className=\"room-info-container\" key={item._id}>\n            <div className=\"room-main-infos\">\n              <div className=\"room-title\">{item.title}</div>\n              <div className=\"room-desc\">{item.desc}</div>\n              <div className=\"room-price\">${item.price}</div>\n              <div className=\"room-max\">\n                Max people: <b>{item.maxPeople}</b>\n              </div>\n            </div>\n            {item.roomNumbers.map((roomNumber) => (\n              <div className=\"room\">\n                <label>{roomNumber.number}</label>\n                <input\n                  className=\"room-check\"\n                  type=\"checkbox\"\n                  value={roomNumber._id}\n                  onChange={handleSelect}\n                  disabled={!isAvailable(roomNumber)}\n                ></input>\n              </div>\n            ))}\n          </div>\n        ))}\n        <button onClick={handleClick} className=\"reserve-button\">\n          {\" \"}\n          RESERVE NOW!{\" \"}\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default Reserve;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}